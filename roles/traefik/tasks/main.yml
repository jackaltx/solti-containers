---
- name: traefik_state
  ansible.builtin.debug:
    var: traefik_state

- name: Install Traefik
  when: traefik_state == 'present'
  block:
    - name: Include prerequisites tasks
      ansible.builtin.include_tasks: prerequisites.yml

    - name: Include container tasks
      ansible.builtin.include_tasks: containers.yml

    - name: Include systemd tasks
      ansible.builtin.include_tasks: systemd.yml

- name: Remove Traefik
  when: traefik_state == 'absent'
  block:
    - name: Include cleanup tasks
      ansible.builtin.include_tasks: cleanup.yml
